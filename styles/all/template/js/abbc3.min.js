let requestRunning=false;let bbwizard;(function($){"use strict";bbwizard=function(href,bbcode){if(!requestRunning){const wizard=$("#bbcode_wizard"),modal=$("#darkenwrapper");if(!wizard.is(":visible")){requestRunning=true;const $loadingIndicator=phpbb.loadingIndicator();$.ajax({url:href,dataType:"html",beforeSend:function(){wizard.hide().empty()},success:function(data){modal.fadeIn("fast");wizard.append(data).fadeIn("fast").find("#bbcode_wizard_submit").attr("data-bbcode",bbcode)},error:function(){bbfontstyle("["+bbcode+"]","[/"+bbcode+"]")},complete:function(){requestRunning=false;if($loadingIndicator&&$loadingIndicator.is(":visible")){$loadingIndicator.fadeOut(phpbb.alertTime)}}})}}};$(function(){const body=$("body");document.querySelectorAll(".abbc3_spoiler").forEach(spoiler=>{const summary=spoiler.querySelector("summary");const showText=spoiler.getAttribute("data-show");const hideText=spoiler.getAttribute("data-hide");spoiler.addEventListener("toggle",()=>{summary.textContent=spoiler.open?hideText:showText})});const wizard=$("#bbcode_wizard"),modal=$("#darkenwrapper");const closeWizard=function(){if(wizard.is(":visible")){wizard.fadeOut("fast");modal.fadeOut("fast")}};body.on("click",closeWizard).on("keyup",function(event){if(event.key==="Escape"||event.keyCode===27){event.preventDefault();closeWizard()}});wizard.on("click","#bbcode_wizard_submit",function(event){event.preventDefault();const bbcode=$(this).data("bbcode");switch(bbcode){case"url":const link=$("#bbcode_wizard_link").val(),description=$("#bbcode_wizard_description").val();insert_text("["+bbcode+(description.length?"="+link:"")+"]"+(description.length?description:link)+""+"[/"+bbcode+"]");break;case"bbvideo":case"media":insert_text("["+bbcode+"]"+$("#bbvideo_wizard_link").val()+""+"[/"+bbcode+"]");break}closeWizard()}).on("click","#bbcode_wizard_cancel",function(event){event.preventDefault();closeWizard()}).on("change","#bbvideo_wizard_sites",function(){$("#bbvideo_wizard_example").val($(this).val())}).on("click",function(event){event.stopPropagation()})})})(jQuery);